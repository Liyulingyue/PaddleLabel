# 图像分类自动标注

<!-- TOC -->

- [自动预标注使用流程](#%E8%87%AA%E5%8A%A8%E9%A2%84%E6%A0%87%E6%B3%A8%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B)

<!-- /TOC -->

{: note}
在使用辅助标注功能前请先按照 [机器学习后端安装](/doc/CN/ML/install_ml.md) 文档介绍步骤安装并启动 PaddleLabel-ML 后端

PaddleLabel-ML 基于[PaddleClas 套件](https://github.com/PaddlePaddle/PaddleClas)中的预训练模型提供图像分类自动标注功能，您只需在“自动推理设置”中进行简单配置，即可启用自动预标注功能。

![](https://user-images.githubusercontent.com/35907364/204250596-061d8193-b011-44b4-9b25-83efc77fef04.gif)

<!-- <div align="center">

<p align="center">
  <img src="https://user-images.githubusercontent.com/35907364/204250596-061d8193-b011-44b4-9b25-83efc77fef04.gif" align="middle" alt="LOGO" width = "500" />
</p>
</div> -->

## 自动预标注使用流程

{: .label }
v0.5.0+

1. 启动

   打开两个命令行终端，第一个输入 `paddlelabel` 并回车，第二个输入 `paddlelabel-ml` 并回车，分别启动项目 web 部分和辅助标注部分
   ![](/doc/CN/assets/start_two.png)

2. 新建分类项目

   可以参考快速体验文档[创建分类样例项目](/doc/CN/quick_start.md#创建样例项目)或[导入一个分类数据集](/doc/CN/quick_start.md#导入数据集)

3. 自动预标注设置

   - 点击“项目总览”页面上方“自动推理设置”按钮进入设置页面
     ![](/doc/CN/assets/to_auto_inference.png)
   - 填写机器学习后端网址。默认为`http://127.0.0.1:1234`。这一网址可以通过观察 paddlelabel-ml 启动时命令行输出确定
     ![](/doc/CN/assets/ml_backend_url.png)
   - 点击模型选择下拉菜单选择一个模型。目前支持 [PPLCNetV2](https://github.com/PaddlePaddle/PaddleClas/blob/release/2.5/docs/zh_CN/models/ImageNet1k/PP-LCNetV2.md)
   - 选择是否使用预标注标签。如果选择是，当推理过程中模型返回了一个项目中还不存在的类别时，会自动向项目中添加该类别标签。如果选择否，您需要提供标签对应关系，将模型返回的接受预标注模型标签后，当模型检测到新标签后，会自动在标签列表中增加该标签

- 使用预标注模型标签（必选）：选择是否使用预标注模型便签，选择'是'则表示用户接受模型推理出的标签来作为图像分类的标注标签，接受预标注模型标签后，当模型检测到新标签后，会自动在标签列表中增加该标签；选择'否'，则用户需要自行建立标签对应关系。

- 标签对应关系（非必填）：如果用户在`使用预标注模型标签`选项栏中选择'是'，则`标签对应关系`处可不填，选择'否'，此时`标签对应关系`处显示两个选择框，左侧的选择框中的标签为模型推理的标签，支持模糊搜索，右侧的选择框中的标签为标签列表中出现过的标签，用户也可以在此处新增标签，用户可按照自己的偏好建立标签对，这样就实现了模型推理标签和用户自定义标签的一一对应，从而就可以在图像分类智能标注中只展示符合用户自定义标签的结果。

  最后选择`确定`按钮，即可完成"自动推理设置"

  1. 点击"去标注"，进入标注界面

  2. 点击"自动推理"，模型给出的预测结果即可显示到标签列表中，如果提示"自动推理未发现高置信度结果"，则可点击"推理阈值"，相应的调低推理阈值后再次点击"自动推理"，即可得到预测结果

  3. 如果对自动推理的结果不满意，用户可点击`清空标注`按钮以及`添加标签`按钮来为当前图像进行手动添加标签进行标注

  4. 点击左右按钮切换图像，重复上述步骤 4 和步骤 5 操作，直到所有数据标注完毕

  5. 下方进度展示可以查看标注进度

  6. **完成标注**

  - 完成数据标注后，PaddleLabel 提供了方便的数据划分功能，以便与 Paddle 其他工具套件（如 PaddleClas）进行快速衔接。点击右侧工具栏的**项目总览**按钮，来到该项目的总览界面，这里可以看到数据以及标注状态。

  - 点击**划分数据集**按钮弹出划分比例的设置，分别填入对应训练集、验证集和测试集的占比，点击确定即可完成数据集的划分。

  - 点击**导出数据集**，输入需要导出到的文件夹路径，点击确认，即可导出标注完成的数据到指定路径。
